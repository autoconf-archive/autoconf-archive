# .travis.yml

language: c
os: linux
dist: xenial
git:
  depth: 50000

addons:
  apt:
    packages:
      - gnulib
      - lzip
      - python3
      - texlive
      - texinfo
      - tidy
      - autoconf
      - automake
      - sed

script:
  - ./bootstrap.sh
  - ./configure --enable-maintainer-mode
  - make PYTHON=python3 -j$(nproc) maintainer-all all
  - env | sort | uniq
  - make check
  - make distcheck AM_DISTCHECK_DVI_TARGET=""
  - if test -e doc/all-macros.texi; then make web-manual; else echo "missing doc/all-macros.texi!" >&2 && exit 1; fi
  - ./fix-website.sh
